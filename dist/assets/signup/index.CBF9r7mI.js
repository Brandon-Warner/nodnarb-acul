import{j as e,r as x}from"../shared/react-vendor.C9XDpjI-.js";import{e as k,n as te,o as re,p as se,h as oe,i as ae,j as ne,u as ie,v as le,s as ce,b as v,a8 as H,c as F,d as O,f as A,a9 as de,F as ue,U as me,a as pe,w as he,C as xe,a7 as fe,g as ge,k as be,x as Ce,l as je,m as we,y as W}from"../shared/common.lOgDNxwW.js";import{bj as Te,bk as Se,bl as ye,D as Le,G as ke,bm as ve,b2 as Fe,bn as Ae}from"../shared/vendor.CuJT1XvO.js";const Pe={title:"Signup",separator:"OR"},Ne={logoAlt:"Application Logo",title:"Welcome",description:"Sign up to continue to your application."},Ue={fields:{password:{label:"Password",required:"Password is required",doesNotMeetRequirements:"Password does not meet requirements"},captcha:{label:"CAPTCHA",imageAlt:"CAPTCHA challenge",required:"Please complete the CAPTCHA"},common:{required:"This field is required"}},button:"Continue",passwordSecurity:"Your password must contain:"},Ee={text:"Already have an account?",linkText:"Log in"},qe={continueWith:"Continue with"},Ve={general:"An error occurred"},$e={page:Pe,header:Ne,form:Ue,footer:Ee,social:qe,errors:Ve},C=()=>{const s=Te(),a=Se(),i=ye(),{alternateConnections:c}=i,{isCaptchaAvailable:r,texts:u,loginLink:o,captcha:d}=a;return{signup:s,transaction:i,handleSignup:async n=>{const m={};n.email?.trim()&&(m.email=n.email.trim()),n.phoneNumber?.trim()&&(m.phoneNumber=n.phoneNumber.trim()),n.username?.trim()&&(m.username=n.username.trim()),a.isCaptchaAvailable&&n.captcha?.trim()&&(m.captcha=n.captcha.trim()),n.password&&(m.password=n.password);const w={...m,password:m.password?"[REDACTED]":void 0};k(`Signup with options: ${JSON.stringify(w)}`,()=>s.signup(m))},handleFederatedSignup:async n=>{k(`Federated signup with connection: ${n.connection}`,()=>s.federatedSignup(n))},handlePickCountryCode:async()=>{k("Pick country code",()=>s.pickCountryCode())},texts:u,isCaptchaAvailable:r,loginLink:o,alternateConnections:c,captcha:d,locales:$e}},De=()=>{const{alternateConnections:s,handleFederatedSignup:a,locales:i}=C(),c=r=>{const u={connection:r.name,...r.metadata||{}};a(u)};return!s||s.length===0?null:e.jsx("div",{className:"space-y-3 mt-2",children:s.map(r=>{if(!r?.name)return null;const{displayName:u,iconComponent:o}=te(r),d=`${i.social.continueWith} ${u}`;return e.jsx(re,{displayName:u,buttonText:d,iconComponent:o,onClick:()=>c(r)},r.name)})})};function Ie(){const{loginLink:s,texts:a,locales:i}=C();if(!s)return null;const c=a?.footerText||i.footer.text,r=a?.footerLinkText||i.footer.linkText;return e.jsxs("div",{className:"mt-4 text-left",children:[e.jsx("span",{className:"pr-1 text-body-text text-(length:--ul-theme-font-body-text-size) font-body",children:c}),s&&e.jsx(se,{href:s,children:r})]})}function Me(){const{texts:s,locales:a}=C(),i=s?.logoAltText||a.header.logoAlt,c=s?.title||a.header.title,r=s?.description||a.header.description;return e.jsxs(e.Fragment,{children:[e.jsx(oe,{altText:i}),e.jsx(ae,{children:c}),e.jsx(ne,{children:r})]})}function Be(){const{handleSignup:s,handlePickCountryCode:a,isCaptchaAvailable:i,transaction:c,texts:r,captcha:u,locales:o}=C(),{errors:d,hasError:f,dismiss:P}=Le(),p=ke({defaultValues:{email:"",phoneNumber:"",username:"",password:"",captcha:""},reValidateMode:"onBlur"}),{formState:{isSubmitting:n},watch:m}=p,w=m("username"),{isValid:N,errors:U}=ve(w||""),E=m("password"),{isValid:K,results:R}=Fe(E||""),j=Ae(),z=x.useMemo(()=>(j||[]).filter(t=>t.required).map(t=>t.type),[j]),G=x.useMemo(()=>(j||[]).filter(t=>!t.required).map(t=>t.type),[j]),q=x.useCallback(()=>{a()},[a]),J=async t=>{await s(t)},T=x.useCallback(t=>{const l=d.byField(t);return l.length>0?l[0].message:void 0},[d]),Y=d.byField("captcha")[0]?.message,V=d.byField("password")[0]?.message,$=d.byType("auth0").filter(t=>!t.field),Q=r?.passwordPlaceholder?`${r.passwordPlaceholder}*`:`${o.form.fields.password.label}*`,X=r?.captchaCodePlaceholder?`${r.captchaCodePlaceholder}*`:`${o.form.fields.captcha.label}*`,Z=r?.buttonText||o.form.button,_=r?.passwordSecurityText||o.form.passwordSecurity,{captchaConfig:D,captchaProps:ee}=ie(u||void 0,X),I=le(c?.countryCode,c?.countryPrefix),M=x.useCallback((t,l)=>t==="phone"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{selectedCountry:I,onClick:q,fullWidth:!0,placeholder:"Select Country"}),e.jsx(v,{control:p.control,name:"phoneNumber",rules:{required:l?o.form.fields.common.required:!1},render:({field:h,fieldState:g})=>{const{label:S,type:y,autoComplete:L}=H("phone",l,r),b=T("phone");return e.jsxs(F,{children:[e.jsx(O,{...h,value:String(h.value||""),label:S,type:y,autoComplete:L,error:!!g.error||!!b}),e.jsx(A,{sdkError:b,hasFormError:!!g.error})]})}})]},`${l?"required":"optional"}-phone-container`):e.jsx(v,{control:p.control,name:t,rules:{required:l?o.form.fields.common.required:!1,...t==="username"&&{validate:de(N,U,l,o.form.fields.common.required)}},render:({field:h,fieldState:g})=>{const{label:S,type:y,autoComplete:L}=H(t,l,r),b=T(t);return e.jsxs(F,{children:[e.jsx(O,{...h,label:S,type:y,autoComplete:L,error:!!g.error||!!b}),e.jsx(A,{sdkError:b,hasFormError:!!g.error})]})}},t),[p.control,o.form.fields.common.required,N,U,I,q,r,T]),B=x.useCallback((t,l)=>t.map(h=>M(h,l)),[M]);return e.jsx(ue,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(J),children:[f&&$.length>0&&e.jsx("div",{className:"space-y-3 mb-4",children:$.map(t=>e.jsx(me,{variant:"destructive",onDismiss:()=>P(t.id),children:e.jsx(pe,{children:t.message||o.errors.general})},t.id))}),B(z,!0),B(G,!1),e.jsx(v,{control:p.control,name:"password",rules:{required:o.form.fields.password.required,validate:()=>K?!0:o.form.fields.password.doesNotMeetRequirements},render:({field:t,fieldState:l})=>e.jsxs(F,{children:[e.jsx(he,{...t,value:String(t.value||""),label:Q,autoComplete:"new-password",error:!!l.error||!!V}),e.jsx(A,{sdkError:V,hasFormError:!!l.error})]})}),i&&D&&e.jsx(xe,{control:p.control,name:"captcha",captcha:D,...ee,sdkError:Y,rules:{required:o.form.fields.captcha.required}}),e.jsx(fe,{validationRules:R,passwordSecurityText:_,show:!!E}),e.jsx(ge,{type:"submit",className:"w-full",disabled:n,children:Z})]})})}function Ke(){const{signup:s,texts:a,alternateConnections:i,locales:c}=C(),r=i&&i.length>0,u=a?.separatorText||c.page.separator;document.title=a?.pageTitle||c.page.title,be(s);const o=Ce("--ul-theme-widget-social-buttons-layout"),d=f=>e.jsxs(e.Fragment,{children:[f==="bottom"&&r&&e.jsx(W,{text:u}),e.jsx(De,{}),f==="top"&&r&&e.jsx(W,{text:u})]});return e.jsx(je,{className:"theme-universal",children:e.jsxs(we,{className:"w-full max-w-[400px] gap-0",children:[e.jsx(Me,{}),o==="top"&&d("top"),e.jsx(Be,{}),e.jsx(Ie,{}),o==="bottom"&&d("bottom")]})})}export{Ke as default};
//# sourceMappingURL=index.CBF9r7mI.js.map
